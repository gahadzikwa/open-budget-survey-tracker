{% import "helpers.html" as h %}

<div class="modal-dialog">
  <div class="modal-content">
    <div class="modal-header">
      <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">{{ gettext("Close") }}</span></button>
      <h4 class="modal-title">{{ country.country }}</h4>
    </div>
    {% if country.obi_scores %}
      <div class="modal-body">
        <p><strong>Open Budget Index ({{ country.obi_scores|last.year }}):</strong> {{ country.obi_scores|last.score }}/100</p>
      </div>
    {% endif %}
    <table class="table table-hover modal-table">
      <colgroup>
        <col width="40%">
        <col width="20%">
        <col width="20%">
        <col width="20%">
      </colgroup>
      <thead>
        <tr>
          <th>{{ gettext("Document") }}</th>
          <th>{{ gettext("Status") }}</th>
          <th>{{ gettext("Date of publication") }}</th>
          <th><span class="text-muted">{{ gettext("Expected date") }}</span></th>
        </tr>
      </thead>
      <tbody>
        {% for doc in docs %}
          {% set cells = country.documents|last[doc.title] %}
          <tr>
            <th scope="row">
              {{ doc.title }}
            </th>
            {% if cells %}
              <td>
                <span class="badge state state-{{ cells|last.state }}">
                  <span>{{ h.state(cells|last.state) }}</span>
                </span>
                {{ h.state(cells|last.state) }}
              </td>
              <td>
                {{ cells|last.date_published }}
              </td>
              <td>
                <span class="text-muted">
                  {{ cells|last.date_expected }}
                </span>
              </td>
            {% else %}
              <td>
                <span class="badge state state-late">
                  <span>{{ gettext("Not produced") }}</span>
                </span>
                {{ gettext("Not produced") }}
              </td>
              <td>
                <span class="text-muted">{{ gettext("Unavailable") }}</span>
              </td>
              <td>
                <span class="text-muted">{{ gettext("Unavailable") }}</span>
              </td>
            {% endif %}
          </tr>
        {% endfor %}
      </tbody>
    </table>
    <div class="modal-footer">
      <a href="https://drive.google.com/a/okfn.org/folderview?pli=1&ddrp=1&id=0ByA9wmvBrAnZN3ZrdzNzcS1JZzg#" class="btn btn-primary">{{ gettext("View the Budget Library") }}</a>
      <a href="/country/{{ country.country }}" class="btn btn-primary">{{ gettext("View historical information") }}</a>
    </div>
  </div>
</div>
